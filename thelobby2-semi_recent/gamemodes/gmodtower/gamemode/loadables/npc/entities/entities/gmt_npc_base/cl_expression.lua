-- lua_run local ent = Entity(1):GetEyeTrace().Entity for i=0,ent:GetFlexNum() do print("[" .. i .. "] = " .. ent:GetFlexWeight(i) .. ",") end
local expressions = {
	happy = {
		scale = 1.34,
		weights = {
			[8]		=	0.48,
			[9]		=	0.17,
			[10]	=	0.31,
			[11]	=	0.06,
			[12]	=	0.35,
			[15]	=	0.28,
			[16]	=	0.10,
			[17]	=	0.10,
			[19]	=	0.15,
			[22]	=	1,
			[23]	=	1,
			[45]	=	0.578,
			[46]	=	0.208,
			[47]	=	0.694,
			[48]	=	0.984,
			[49]	=	0.451,
			[50]	=	0.673,
			[51]	=	0.746,
			[52]	=	0.603,
			[53]	=	0.143,
			[54]	=	0.018,
			[55]	=	0.106,
			[56]	=	0.265,
			[57]	=	0.979,
			[58]	=	0.771,
			[59]	=	0.507,
			[60]	=	0.703,
			[61]	=	0.960,
			[62]	=	0.253,
			[63]	=	0.545,
			[64]	=	0.561,
			[65]	=	0.448,
			[66]	=	0.933,
			[67]	=	0.666,
			[68]	=	0.552,
			[69]	=	0.870,
			[70]	=	0.263,
			[71]	=	0.705,
			[72]	=	0.020,
			[73]	=	0.781,
			[74]	=	0.599,
			[75]	=	0.409,
			[76]	=	0.725,
			[77]	=	0.154,
			[78]	=	0.965,
			[79]	=	0.524,
			[80]	=	0.517,
			[81]	=	0.125,
			[82]	=	0.595,
			[83]	=	0.509,
			[84]	=	0.471,
			[85]	=	0.551,
			[86]	=	0.737,
			[87]	=	0.599,
			[88]	=	0.630,
			[89]	=	0.402,
			[90]	=	0.214,
			[91]	=	0.625,
			[92]	=	0.121,
			[93]	=	0.541,
			[94]	=	0.105,
			[95]	=	0.965,
			[96]	=	0.008,
			[97]	=	0.643,
			[98]	=	0.071,
			[99]	=	0.971,
			[100]	=	0.543,
			[101]	=	0.925,
			[102]	=	0.972,
			[103]	=	0.884,
			[104]	=	0.344,
			[105]	=	0.738,
			[106]	=	0.806,
			[107]	=	0.881,
			[108]	=	0.194,
			[109]	=	0.352,
			[110]	=	0.443,
			[111]	=	0.776,
			[112]	=	0.575,
			[113]	=	0.388,
			[114]	=	0.879,
			[115]	=	0.245,
			[116]	=	0.481,
			[117]	=	0.835,
			[118]	=	0.312,
			[119]	=	0.939,
			[120]	=	0.768,
			[121]	=	0.560,
			[122]	=	0.836,
			[123]	=	0.532,
			[124]	=	0.280,
			[125]	=	0.716,
			[126]	=	0.774,
			[128]	=	0.456
		}
	},
	pissed = {
		scale = 1.34,
		weights = {
			[0] = 0.88,
			[1] = 0.13,
			[2] = 0.68,
			[3] = 0.28,
			[4] = 0.53,
			[5] = 0.87,
			[8] = 0.17,
			[10] = 0.40,
			[11] = 0.93,
			[12] = 0.29,
			[13] = 0.90,
			[14] = 0.79,
			[15] = 0.98,
			[16] = 0.48,
			[17] = 0.40,
			[18] = 0.54,
			[19] = 0.83,
			[20] = 0.77,
			[21] = 0.13,
			[22] = 0.96,
			[23] = 0.99,
			[24] = 0.34,
			[25] = 1.00,
			[26] = 1.00,
			[27] = 0.95,
			[28] = 1.00,
			[29] = 1.00,
			[30] = 1.00,
			[31] = 1.00,
			[32] = 1.00,
			[33] = 1.00,
			[34] = 1.00,
			[35] = 0.43,
			[36] = 0.29,
			[37] = 1.00,
			[38] = 1.00,
			[39] = 1.00,
			[40] = 1.00,
			[41] = 1.00,
			[44] = 0.037,
			[45] = 0.341,
			[46] = 0.045,
			[47] = 0.246,
			[48] = 0.519,
			[49] = 0.798,
			[50] = 0.119,
			[51] = 0.532,
			[52] = 0.340,
			[53] = 0.407,
			[54] = 0.438,
			[55] = 0.534,
			[56] = 0.351,
			[57] = 0.086,
			[58] = 0.625,
			[59] = 0.952,
			[60] = 0.214,
			[61] = 0.264,
			[62] = 0.373,
			[63] = 0.919,
			[64] = 0.824,
			[65] = 0.262,
			[66] = 0.009,
			[67] = 0.102,
			[68] = 0.867,
			[69] = 0.111,
			[70] = 0.138,
			[71] = 0.420,
			[72] = 0.853,
			[73] = 0.572,
			[74] = 0.315,
			[75] = 0.094,
			[76] = 0.005,
			[77] = 0.395,
			[78] = 0.511,
			[79] = 0.899,
			[80] = 0.621,
			[81] = 0.059,
			[82] = 0.026,
			[83] = 0.927,
			[84] = 0.616,
			[85] = 0.490,
			[86] = 0.567,
			[87] = 0.392,
			[88] = 0.229,
			[89] = 0.124,
			[90] = 0.607,
			[91] = 0.553,
			[92] = 0.249,
			[93] = 0.378,
			[94] = 0.684,
			[95] = 0.889,
			[96] = 0.341,
			[97] = 0.379,
			[98] = 0.460,
			[99] = 0.652,
			[100] = 0.608,
			[101] = 0.400,
			[102] = 0.527,
			[103] = 0.181,
			[104] = 0.542,
			[105] = 0.195,
			[106] = 0.874,
			[107] = 0.574,
			[108] = 0.014,
			[109] = 0.786,
			[110] = 0.201,
			[111] = 0.232,
			[112] = 0.547,
			[113] = 0.873,
			[114] = 0.794,
			[115] = 0.055,
			[116] = 0.133,
			[117] = 0.970,
			[118] = 0.990,
			[119] = 0.304,
			[120] = 0.879,
			[121] = 0.083,
			[122] = 0.982,
			[123] = 0.731,
			[124] = 0.945,
			[125] = 0.558,
			[126] = 0.212,
			[127] = 0.404,
			[128] = 0.128
		}
	},
	joker = {
		scale = 7.235294,
		weights = {
			[0] = 1.000000,
			[1] = 1.000000,
			[2] = 1.000000,
			[3] = 1.000000,
			[4] = 1.000000,
			[5] = 1.000000,
			[12] = 0.656863,
			[13] = 0.490196,
			[19] = 1.000000,
			[20] = 1.000000,
			[21] = 1.000000,
			[22] = 1.000000,
			[23] = 1.000000,
			[27] = 1.000000,
			[28] = 1.000000,
			[31] = 1.000000,
			[32] = 1.000000,
			[33] = 1.000000,
			[34] = 1.000000,
			[40] = 1.000000,
			[42] = 0.632353,
			[54] = 1,
			[55] = 0.500000,
			[56] = 0.500000,
			[57] = 0.500000,
			[58] = 0.500000,
			[59] = 0.500000,
			[60] = 0.500000,
			[61] = 0.500000,
			[62] = 0.500000,
			[63] = 0.500000,
			[64] = 0.500000
		}
	},
	sorry = {
		scale = 1.000000,
		weights = {
			[0] = 1.000000,
			[1] = 1.000000,
			[10] = 1.000000,
			[11] = 1.000000,
			[18] = 0.471000,
			[24] = 1.000000,
			[25] = 1.000000,
			[26] = 0.990000,
			[28] = 0.544000,
			[29] = 1.000000,
			[30] = 1.000000,
			[34] = 1.000000,
			[35] = 1.000000,
			[38] = 1.000000,
			[40] = 1.000000,
			[41] = 1.000000,
			[54] = 0.500000,
			[55] = 0.500000,
			[56] = 0.500000,
			[57] = 0.500000,
			[58] = 0.500000,
			[59] = 0.500000,
			[60] = 0.500000,
			[61] = 0.500000,
			[62] = 0.500000,
			[63] = 0.500000,
			[64] = 0.500000
		}
	},
	retarded = {
		scale = 1.34,
		weights = {
			[0] = 0.22,
			[1] = 0.89,
			[7] = 0.17,
			[9] = 0.30,
			[10] = 0.36,
			[11] = 0.37,
			[12] = 0.44,
			[13] = 0.84,
			[14] = 0.15,
			[15] = 0.09,
			[16] = 0.12,
			[17] = 0.97,
			[18] = 0.54,
			[19] = 0.78,
			[20] = 1.00,
			[21] = 1.00,
			[22] = 1.00,
			[23] = 1.00,
			[27] = 1.00,
			[28] = 1.00,
			[33] = 1.00,
			[34] = 1.00,
			[39] = 1.00,
			[42] = 1.00,
			[43] = 1.00,
			[44] = 0.481,
			[45] = 0.407,
			[46] = 0.526,
			[47] = 0.891,
			[48] = 0.212,
			[49] = 0.312,
			[50] = 0.056,
			[51] = 0.731,
			[52] = 0.263,
			[53] = 0.265,
			[54] = 0.212,
			[55] = 0.241,
			[56] = 0.177,
			[57] = 0.429,
			[58] = 0.236,
			[59] = 0.780,
			[60] = 0.350,
			[61] = 0.521,
			[62] = 0.224,
			[63] = 0.394,
			[64] = 0.995,
			[65] = 0.025,
			[66] = 0.964,
			[67] = 0.566,
			[68] = 0.951,
			[69] = 0.410,
			[70] = 0.708,
			[71] = 0.153,
			[72] = 0.872,
			[73] = 0.249,
			[74] = 0.777,
			[75] = 0.585,
			[76] = 0.554,
			[77] = 0.680,
			[78] = 0.474,
			[79] = 0.142,
			[80] = 0.933,
			[81] = 0.073,
			[82] = 0.474,
			[83] = 0.627,
			[84] = 0.580,
			[85] = 0.201,
			[86] = 0.980,
			[87] = 0.393,
			[88] = 0.252,
			[89] = 0.469,
			[90] = 0.893,
			[91] = 0.588,
			[92] = 0.361,
			[93] = 0.458,
			[94] = 0.885,
			[95] = 0.740,
			[96] = 0.630,
			[97] = 0.361,
			[98] = 0.085,
			[99] = 0.249,
			[100] = 0.122,
			[101] = 0.055,
			[102] = 0.208,
			[103] = 0.308,
			[104] = 0.450,
			[105] = 0.475,
			[106] = 0.671,
			[107] = 0.396,
			[108] = 0.713,
			[109] = 0.337,
			[110] = 0.030,
			[111] = 0.894,
			[112] = 0.359,
			[113] = 0.263,
			[114] = 0.698,
			[115] = 0.630,
			[116] = 0.728,
			[117] = 0.465,
			[118] = 0.132,
			[119] = 0.668,
			[120] = 0.818,
			[121] = 0.451,
			[122] = 0.701,
			[123] = 0.692,
			[124] = 0.558,
			[125] = 0.311,
			[126] = 0.042,
			[127] = 0.929,
			[128] = 0.324
		}
	},
	despair = {
		scale = -1.34,
		weights = {
			[0] = 0.30,
			[1] = 0.50,
			[2] = 0.50,
			[3] = 0.51,
			[4] = 0.16,
			[5] = 0.61,
			[6] = 0.71,
			[7] = 0.69,
			[8] = 0.56,
			[9] = 0.92,
			[10] = 0.19,
			[11] = 0.70,
			[12] = 0.25,
			[13] = 0.29,
			[14] = 0.76,
			[15] = 0.94,
			[16] = 0.53,
			[17] = 0.86,
			[18] = 0.34,
			[19] = 0.39,
			[20] = 0.30,
			[21] = 0.15,
			[22] = 0.78,
			[23] = 0.04,
			[24] = 0.87,
			[25] = 0.77,
			[26] = 0.04,
			[27] = 0.32,
			[28] = 0.14,
			[29] = 0.45,
			[30] = 0.39,
			[31] = 0.19,
			[32] = 0.06,
			[33] = 0.86,
			[34] = 0.27,
			[35] = 0.32,
			[36] = 0.95,
			[37] = 0.37,
			[38] = 0.31,
			[39] = 0.67,
			[40] = 0.98,
			[41] = 0.59,
			[42] = 0.64,
			[43] = 0.59,
			[44] = 0.146,
			[45] = 0.566,
			[46] = 0.558,
			[47] = 0.650,
			[48] = 0.621,
			[49] = 0.272,
			[50] = 0.071,
			[51] = 0.814,
			[52] = 0.557,
			[53] = 0.006,
			[54] = 0.968,
			[55] = 0.838,
			[56] = 0.326,
			[57] = 0.957,
			[58] = 0.139,
			[59] = 0.683,
			[60] = 0.231,
			[61] = 0.397,
			[62] = 0.643,
			[63] = 0.250,
			[64] = 0.057,
			[65] = 0.961,
			[66] = 0.756,
			[67] = 0.170,
			[68] = 0.621,
			[69] = 0.382,
			[70] = 0.391,
			[71] = 0.775,
			[72] = 0.095,
			[73] = 0.738,
			[74] = 0.239,
			[75] = 0.259,
			[76] = 0.341,
			[77] = 0.574,
			[78] = 0.614,
			[79] = 0.543,
			[80] = 0.708,
			[81] = 0.239,
			[82] = 0.895,
			[83] = 0.417,
			[84] = 0.711,
			[85] = 0.365,
			[86] = 0.387,
			[87] = 0.110,
			[88] = 0.114,
			[89] = 0.685,
			[90] = 0.181,
			[91] = 0.734,
			[92] = 0.782,
			[93] = 0.146,
			[94] = 0.053,
			[95] = 0.423,
			[96] = 0.079,
			[97] = 0.302,
			[98] = 0.770,
			[99] = 0.127,
			[100] = 0.158,
			[101] = 0.364,
			[102] = 0.541,
			[103] = 0.808,
			[104] = 0.878,
			[105] = 0.114,
			[106] = 0.127,
			[107] = 0.087,
			[108] = 0.721,
			[109] = 0.281,
			[110] = 0.359,
			[111] = 0.080,
			[112] = 0.304,
			[113] = 0.305,
			[114] = 0.623,
			[115] = 0.389,
			[116] = 0.335,
			[117] = 0.690,
			[118] = 0.595,
			[119] = 0.692,
			[120] = 0.172,
			[121] = 0.161,
			[122] = 0.763,
			[123] = 0.165,
			[124] = 0.269,
			[125] = 0.352,
			[126] = 0.416,
			[127] = 0.291,
			[128] = 0.207
		}
	},
	verysad = {
		scale = -1.65,
		weights = {
			[0] = 0.13,
			[1] = 0.33,
			[2] = 0.63,
			[3] = 0.07,
			[4] = 0.54,
			[5] = 0.44,
			[6] = 0.03,
			[7] = 0.36,
			[8] = 0.04,
			[9] = 0.30,
			[10] = 0.07,
			[11] = 0.07,
			[12] = 0.80,
			[13] = 0.10,
			[14] = 0.51,
			[15] = 0.36,
			[16] = 0.01,
			[17] = 0.10,
			[18] = 0.36,
			[19] = 0.75,
			[20] = 0.84,
			[21] = 0.24,
			[22] = 0.44,
			[23] = 0.22,
			[24] = 0.03,
			[25] = 0.80,
			[26] = 0.29,
			[27] = 0.09,
			[28] = 0.45,
			[29] = 0.02,
			[30] = 0.89,
			[31] = 0.25,
			[32] = 0.12,
			[33] = 0.63,
			[34] = 0.69,
			[35] = 0.14,
			[36] = 0.63,
			[37] = 0.46,
			[38] = 0.07,
			[39] = 0.95,
			[40] = 0.95,
			[41] = 0.90,
			[42] = 0.79,
			[43] = 0.47,
			[44] = 0.804,
			[45] = 0.255,
			[46] = 0.034,
			[47] = 0.539,
			[48] = 0.400,
			[49] = 0.226,
			[50] = 0.375,
			[51] = 0.330,
			[52] = 0.313,
			[53] = 0.755,
			[54] = 0.007,
			[55] = 0.884,
			[56] = 0.038,
			[57] = 0.303,
			[58] = 0.297,
			[59] = 0.881,
			[60] = 0.102,
			[61] = 0.340,
			[62] = 0.039,
			[63] = 0.249,
			[64] = 0.007,
			[65] = 0.121,
			[66] = 0.137,
			[67] = 0.183,
			[68] = 0.133,
			[69] = 0.078,
			[70] = 0.495,
			[71] = 0.157,
			[72] = 0.231,
			[73] = 0.684,
			[74] = 0.341,
			[75] = 0.513,
			[76] = 0.088,
			[77] = 0.199,
			[78] = 0.570,
			[79] = 0.910,
			[80] = 0.219,
			[81] = 0.798,
			[82] = 0.688,
			[83] = 0.611,
			[84] = 0.713,
			[85] = 0.435,
			[86] = 0.229,
			[87] = 0.915,
			[88] = 0.191,
			[89] = 0.778,
			[90] = 0.122,
			[91] = 0.293,
			[92] = 0.600,
			[93] = 0.466,
			[94] = 0.159,
			[95] = 0.440,
			[96] = 0.758,
			[97] = 0.660,
			[98] = 0.525,
			[99] = 0.055,
			[100] = 0.734,
			[101] = 0.592,
			[102] = 0.358,
			[103] = 0.058,
			[104] = 0.631,
			[105] = 0.766,
			[106] = 0.774,
			[107] = 0.473,
			[108] = 0.964,
			[109] = 0.510,
			[110] = 0.679,
			[111] = 0.132,
			[112] = 0.781,
			[113] = 0.063,
			[114] = 0.176,
			[115] = 0.956,
			[116] = 0.471,
			[117] = 0.842,
			[118] = 0.851,
			[119] = 0.018,
			[120] = 0.843,
			[121] = 0.623,
			[122] = 0.378,
			[123] = 0.983,
			[124] = 0.189,
			[125] = 0.372,
			[126] = 0.184,
			[127] = 0.107,
			[128] = 0.135
		}
	},
	nervous = {
		scale = 1.34,
		weights = {
			[8] = 0.74,
			[9] = 0.05,
			[10] = 1.00,
			[11] = 1.00,
			[16] = 0.48,
			[17] = 0.68,
			[18] = 0.75,
			[19] = 0.82,
			[20] = 1,
			[21] = 1,
			[22] = 1,
			[23] = 1,
			[27] = 0.60,
			[28] = 0.40,
			[33] = 1,
			[34] = 1,
			[40] = 1.00,
			[41] = 1.00,
			[45] = 0.305,
			[46] = 0.633,
			[47] = 0.205,
			[48] = 0.433,
			[49] = 0.096,
			[50] = 0.675,
			[51] = 0.089,
			[52] = 0.076,
			[53] = 0.142,
			[54] = 0.857,
			[55] = 0.389,
			[56] = 0.591,
			[57] = 0.999,
			[58] = 0.306,
			[59] = 0.816,
			[60] = 0.158,
			[61] = 0.187,
			[62] = 0.948,
			[63] = 0.470,
			[64] = 0.670,
			[65] = 0.903,
			[66] = 0.950,
			[67] = 0.090,
			[68] = 0.294,
			[69] = 0.509,
			[70] = 0.183,
			[71] = 0.641,
			[72] = 0.876,
			[73] = 0.493,
			[74] = 0.750,
			[75] = 0.054,
			[76] = 0.743,
			[77] = 0.331,
			[78] = 0.512,
			[79] = 0.693,
			[80] = 0.694,
			[81] = 0.409,
			[82] = 0.570,
			[83] = 0.056,
			[84] = 0.411,
			[85] = 0.696,
			[86] = 0.809,
			[87] = 0.386,
			[88] = 0.497,
			[89] = 0.048,
			[90] = 0.905,
			[91] = 0.871,
			[92] = 0.099,
			[93] = 0.904,
			[94] = 0.765,
			[95] = 0.754,
			[96] = 0.520,
			[97] = 0.301,
			[98] = 0.054,
			[99] = 0.548,
			[100] = 0.699,
			[101] = 0.217,
			[102] = 0.866,
			[103] = 0.080,
			[104] = 0.793,
			[105] = 0.699,
			[106] = 0.491,
			[107] = 0.702,
			[108] = 0.339,
			[109] = 0.956,
			[110] = 0.546,
			[111] = 0.997,
			[112] = 0.137,
			[113] = 0.138,
			[114] = 0.208,
			[115] = 0.006,
			[116] = 0.493,
			[117] = 0.554,
			[118] = 0.651,
			[119] = 0.749,
			[120] = 0.185,
			[121] = 0.811,
			[122] = 0.324,
			[123] = 0.383,
			[124] = 0.971,
			[125] = 0.912,
			[126] = 0.334,
			[127] = 0.809,
			[128] = 0.158
		}
	},

	blank = {
		scale = 0,
		weights = {}
	}
}

function ENT:SetExpression( name )
	local ent = self
	-- if not IsValid(ent) then return end

	local flex = expressions[name]
	if not flex then
		ErrorNoHalt( "Attempted to set invalid expression '" .. tostring(name)
			.. "' on GMT NPC (" .. tostring(self) .. ")\n" )
		return
	end

	if name == "nervous" then
		flex.scale = math.Rand( 0.72, 1.34 )
	end

	local weight
	for i = 1, ent:GetFlexNum() do
		weight = flex.weights[i] or 0
		ent:SetFlexWeight( i, weight )
	end

	ent:SetFlexScale( flex.scale or 1 )
end